"use strict";(self.webpackChunkcreate_project_docs=self.webpackChunkcreate_project_docs||[]).push([[1684],{28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var r=t(96540);const s={},i=r.createContext(s);function o(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},81456:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"system-architecture/Infrastructure-Architecture","title":"Production Architecture","description":"Overview","source":"@site/docs/system-architecture/Infrastructure-Architecture.md","sourceDirName":"system-architecture","slug":"/system-architecture/Infrastructure-Architecture","permalink":"/project-code-battlegrounds-1-5/docs/system-architecture/Infrastructure-Architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/Capstone-Projects-2026-spring/project-code-battlegrounds-1-5/edit/main/documentation/docs/system-architecture/Infrastructure-Architecture.md","tags":[],"version":"current","lastUpdatedBy":"Julia Fasick","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"System Architecture","permalink":"/project-code-battlegrounds-1-5/docs/category/system-architecture"},"next":{"title":"design","permalink":"/project-code-battlegrounds-1-5/docs/system-architecture/design"}}');var s=t(74848),i=t(28453);const o={sidebar_position:1},a="Production Architecture",c={},l=[{value:"Overview",id:"overview",level:2},{value:"Diagram and Explanation",id:"diagram-and-explanation",level:2},{value:"Detailed Breakdown",id:"detailed-breakdown",level:2},{value:"Artifact Registry",id:"artifact-registry",level:3},{value:"Cloud Run Service",id:"cloud-run-service",level:3},{value:"Cloud Run Migrate Job",id:"cloud-run-migrate-job",level:3},{value:"CloudSQL",id:"cloudsql",level:3},{value:"Serverless VPC Access Connector",id:"serverless-vpc-access-connector",level:3},{value:"Memorystore",id:"memorystore",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"production-architecture",children:"Production Architecture"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.p,{children:["The architecture is designed with a high level of inherent scalability, both vertically and horizontally. This is\nachieved with an ephemeral, stateless application that can be autoscaled by orchestration systems. For local\ndevelopment, the application can be run with a ",(0,s.jsx)(n.code,{children:".env"})," file and ",(0,s.jsx)(n.code,{children:"docker-compose.yml"}),"\nfile . This environment maps\nperfectly to production, as discussed later."]}),"\n",(0,s.jsxs)(n.p,{children:["The API will connect with two different data stores. For quick-access, ephemeral data, ",(0,s.jsx)(n.a,{href:"https://redis.io/",children:"Redis"})," will\nbe utilized. For an authoritative data store, ",(0,s.jsx)(n.a,{href:"https://www.postgresql.org/",children:"PostgreSQL"})," will be used. For more\ninformation on the database design, see FILLER. "]}),"\n",(0,s.jsx)(n.h2,{id:"diagram-and-explanation",children:"Diagram and Explanation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plantuml-diagram",children:'@startuml\nskinparam shadowing false\nskinparam linetype ortho\nskinparam wrapWidth 200\nskinparam defaultTextAlignment center\nleft to right direction\n\ntitle Production Infrastructure\n\nactor "GitHub Action CI/CD" as cicd\nactor "End User" as user\n\nframe "Google Cloud Project" as project {\n  node "Artifact Registry\\n(DOCKER format)" as ar\n  cloud "VPC Network: vpc" as vpc {\n    node "Serverless VPC Access Connector\\nName: connector" as vpcac\n    rectangle "Subnet: subnet\\nCIDR: 10.10.0.0/24" as subnet {\n      node "Memorystore (Redis)\\nName: redis\\nTier: BASIC, 1 GiB" as redis\n    }\n  }\n  database "Cloud SQL (PostgreSQL 15)\\nInstance: postgres\\nDB: appdb" as sql\n  node "Cloud Run Service\\nName: app" as app\n  node "Cloud Run Job\\nName: migrate-job" as migrate\n\n  \' layout constraint: keep ar to the left of app\n  ar -[hidden]-> app\n}\n\nnote right of sql\n  Accessed using Cloud SQL Auth Proxy and mounted by Cloud Run. Authenticated via service account.\nend note\n\nnote right of redis\n  Redis is only authorized to be accessed through the VPC network, hence the subnet in the VPC and Access Connector.\nend note\n\nmigrate ..> sql\n\nar ..> app : image\nar ..> migrate : image\n\napp --\x3e sql\napp --\x3e vpcac\n\ncicd --\x3e ar\nuser --\x3e app\n@enduml\n'})}),"\n",(0,s.jsxs)(n.p,{children:["The above diagram demonstrates how the application is deployed via a GitHub action CI/CD pipeline. Two images are\ncreated: the actual runner application (minimal, production environment from a multi-stage build) and the ",(0,s.jsx)(n.code,{children:"migrate"}),"\nimage, who's only job is to be run in a Cloud Run Job that deploys database schema updates when needed."]}),"\n",(0,s.jsxs)(n.p,{children:["Note the high level of scalability: vertically, the tiniest, lowest-tier of machines are provisioned, allowing for\nminimal development overhead and easy scaling if it should be needed. Additionally, the Cloud Run Service itself is horizontally\nscalable from 0 -> N as needed. This architecture also allows for later multi-region scaling by moving the Cloud Run\nService into the VPC and creating clones of that VPC for individual regions. If needed, Cloud SQL can be scaled as well,\neven put behind a ",(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/",children:"Kubernetes StatefulSet"})," if\nnecessitated by scale."]}),"\n",(0,s.jsxs)(n.p,{children:["At the time of this writing (2/15/2026), the entire infrastructure has been successfully deployed\nvia ",(0,s.jsx)(n.a,{href:"https://developer.hashicorp.com/terraform",children:"Terraform"}),". Future planned additions\ninclude ",(0,s.jsx)(n.a,{href:"https://cloud.google.com/dns",children:"Cloud DNS"}),", ",(0,s.jsx)(n.a,{href:"https://cloud.google.com/security/products/armor",children:"Cloud Armor"}),"\nand ",(0,s.jsx)(n.a,{href:"https://cloud.google.com/pubsub",children:"Pub/Sub"})," for asynchronous event handling like matchmaking and post-match\nanalytics. Infrastructure declaration files are hosted in a separate Git repo, hosted ",(0,s.jsx)(n.a,{href:"https://git.juliafasick.com/julia/code-battlegrounds-infra",children:"here"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"detailed-breakdown",children:"Detailed Breakdown"}),"\n",(0,s.jsx)(n.h3,{id:"artifact-registry",children:(0,s.jsx)(n.a,{href:"https://docs.cloud.google.com/artifact-registry/docs",children:"Artifact Registry"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Hosts container images built by CI/CD pipeline (specifically, a ",(0,s.jsxs)(n.a,{href:"https://docs.cloud.google.com/sdk/gcloud/reference/builds",children:["\n",(0,s.jsx)(n.code,{children:"gcloud builds"})]})," call)."]}),"\n",(0,s.jsxs)(n.li,{children:["Serves the images as needed to the ",(0,s.jsx)(n.code,{children:"migrate"})," job and the Cloud Run Service itself."]}),"\n",(0,s.jsx)(n.li,{children:"Allows for quick, painless, and reproducible deployment."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"cloud-run-service",children:(0,s.jsx)(n.a,{href:"https://cloud.google.com/run",children:"Cloud Run Service"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Runs the container image pulled from Artifact Registry."}),"\n",(0,s.jsx)(n.li,{children:"Stores ephemeral data in Memorystore."}),"\n",(0,s.jsx)(n.li,{children:"Stores authoritative, persistent data in CloudSQL."}),"\n",(0,s.jsx)(n.li,{children:"Environment variables injected at runtime, so production environment can perfectly match local environment."}),"\n",(0,s.jsxs)(n.li,{children:["0 -> N scaling allows for 0% overhead during idle periods (in contradiction to\ntraditional ",(0,s.jsx)(n.a,{href:"https://cloud.google.com/kubernetes-engine",children:"Google Kubernetes Engine"})," approaches)."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"cloud-run-migrate-job",children:(0,s.jsx)(n.a,{href:"https://docs.cloud.google.com/run/docs/create-jobs",children:"Cloud Run Migrate Job"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Runs specialized image built automagically by the ",(0,s.jsx)(n.code,{children:"gcloud builds"})," call and hosted in the Artifact Registry."]}),"\n",(0,s.jsx)(n.li,{children:"Handles deployment of database schemas and applies migrations as needed."}),"\n",(0,s.jsx)(n.li,{children:"Manually ran only when needed."}),"\n",(0,s.jsx)(n.li,{children:"Removes need for Cloud Run image to handle database deployments and migrations at run time (a security risk and\nhigh-coupled nightmare where database issues will stop the app from even starting)."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"cloudsql",children:(0,s.jsx)(n.a,{href:"https://cloud.google.com/sql",children:"CloudSQL"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Used for authoritative, persistent data store such as problem sets, user data, and match results."}),"\n",(0,s.jsx)(n.li,{children:"Can be vertically and horizontally scaled if needed."}),"\n",(0,s.jsx)(n.li,{children:"Migrations and deployment handled by Cloud Run Job."}),"\n",(0,s.jsx)(n.li,{children:"See FILLER for schema information. "}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"serverless-vpc-access-connector",children:(0,s.jsx)(n.a,{href:"https://docs.cloud.google.com/vpc/docs/serverless-vpc-access",children:"Serverless VPC Access Connector"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Allows serverless traffic from Cloud Run to access Memorystore on the subnet defined."}),"\n",(0,s.jsx)(n.li,{children:"Protects Memorystore, as Memorystore is not designed for any authentication, just low-latency private communications."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"memorystore",children:(0,s.jsx)(n.a,{href:"https://cloud.google.com/memorystore",children:"Memorystore"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Used for low-latency (~1ms), ephemeral storage, such as in-progress match data."}),"\n",(0,s.jsx)(n.li,{children:"No authentication, must be protected by only accepting private connections through the Access Connector."}),"\n",(0,s.jsx)(n.li,{children:"Completed matches will be written to the authoritative store, CloudSQL."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);